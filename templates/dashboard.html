{% extends "base.html" %}
{% block content %}
<h2>Dashboard</h2>

<!-- Tabs Navigation -->
<ul class="nav nav-tabs" id="dashboardTabs" role="tablist">
  <li class="nav-item" role="presentation">
    <button class="nav-link active" id="students-tab" data-bs-toggle="tab" data-bs-target="#students" type="button" role="tab" aria-controls="students" aria-selected="true">
      Students
    </button>
  </li>
  <li class="nav-item" role="presentation">
    <button class="nav-link" id="tasks-tab" data-bs-toggle="tab" data-bs-target="#tasks" type="button" role="tab" aria-controls="tasks" aria-selected="false">
      Tasks
    </button>
  </li>
</ul>

<!-- Tabs Content -->
<div class="tab-content mt-3">
  <!-- Students Tab Pane -->
  <div class="tab-pane fade show active" id="students" role="tabpanel" aria-labelledby="students-tab">
    <div class="list-group">
        {% for student in students %}
        <a href="{{ url_for('student_detail', id=student.id) }}" class="list-group-item list-group-item-action">
            <strong>{{ student.first_name }} {{ student.last_name }}</strong>
            — {{ student.intended_major or 'Undeclared' }}
            <span class="text-muted float-end">Assigned: {{ student.assigned_date }}</span>
        </a>
        {% else %}
        <p>No students found.</p>
        {% endfor %}
    </div>
  </div>

  <!-- Tasks Tab Pane -->
  <div class="tab-pane fade" id="tasks" role="tabpanel" aria-labelledby="tasks-tab">
    <ul class="list-group" id="dashboardTaskList">
        {% for task in all_tasks %}
        <li class="list-group-item d-flex justify-content-between align-items-center" id="task-{{ task.id }}">
            <div>
                <input type="checkbox" class="form-check-input me-2" onchange="toggleTask({{ task.id }})" {% if task.completed %}checked{% endif %}>
                <span id="task-desc-{{ task.id }}" {% if task.completed %}style="text-decoration: line-through; color: grey;"{% endif %}>
                    {{ task.description }} <small class="text-muted">— {{ task.student.first_name }} {{ task.student.last_name }}</small>
                </span>
            </div>
            <div>
                <button class="btn btn-sm btn-danger" onclick="deleteTask({{ task.id }})">Delete</button>
            </div>
        </li>
        {% else %}
        <li class="list-group-item">No tasks yet.</li>
        {% endfor %}
    </ul>
  </div>
</div>

{% endblock %}
